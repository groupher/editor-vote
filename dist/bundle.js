!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Vote=t():e.Vote=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=0)}([function(e,t){function n(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var a=function(){function e(t){t.data,t.config;var n=t.api;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=n,this.data={},this.container=this._make("div",[this.CSS.baseClass,this.CSS.wrapper])}return i(e,[{key:"CSS",get:function(){return{baseClass:this.api.styles.block,wrapper:"cdx-vote",voteBar:"cdx-vote-bar",voteBarInput:"cdx-vote-input",barAdder:"cdx-vote-bar__adder",barDeleter:"cdx-vote-bar__deleter"}}}],[{key:"toolbox",get:function(){return{icon:'<svg t="1573717087071" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2707" width="200" height="200"><path d="M331.5 544h-208c-3.31 0-6-2.69-6-6v-52c0-3.31 2.69-6 6-6h208c3.31 0 6 2.69 6 6v52c0 3.31-2.69 6-6 6z" p-id="2708"></path><path d="M195.5 614V410c0-4.42 3.58-8 8-8h48c4.42 0 8 3.58 8 8v204c0 4.42-3.58 8-8 8h-48c-4.42 0-8-3.58-8-8zM560.58 332.5H111.5v-220h449.08c36.41 0 65.92 29.51 65.92 65.92v88.15c0 36.42-29.51 65.93-65.92 65.93zM560.58 911.5H111.5v-220h449.08c36.41 0 65.92 29.51 65.92 65.92v88.15c0 36.42-29.51 65.93-65.92 65.93zM845.5 622h-385c-35.9 0-65-29.1-65-65v-90c0-35.9 29.1-65 65-65h385c35.9 0 65 29.1 65 65v90c0 35.9-29.1 65-65 65z" p-id="2709"></path></svg>',title:"投票"}}},{key:"enableLineBreaks",get:function(){return!0}},{key:"DEFAULT_TITLE_PLACEHOLDER",get:function(){return"Title"}},{key:"DEFAULT_MESSAGE_PLACEHOLDER",get:function(){return"Message"}}]),i(e,[{key:"removeAllElements",value:function(e){var t=document.querySelector(e);t&&(t.forEach?t.forEach(function(e){return e.parentNode.removeChild(e)}):t.remove())}},{key:"addBar",value:function(){var e=this.makeBar();this.container.appendChild(e)}},{key:"deleteBar",value:function(e){delete this.data[e.index],e.remove()}},{key:"uniqNum",value:function(){return Math.random().toString(36).substr(2,9)}},{key:"makeBar",value:function(){var e=this,t=this.container.childElementCount,n=this._make("div",[this.CSS.voteBar],{index:this.uniqNum()}),r=this._make("div",[this.CSS.voteBarInput],{contentEditable:!0,innerHTML:"投票选项 "+t});return n.appendChild(r),this.removeAllElements("."+this.CSS.barAdder),this.removeAllElements("."+this.CSS.barDeleter),this.api.listeners.on(n,"input",function(t){var n=t.target.parentNode.index,r=t.target.innerText;e.data[n]=r},!0),setTimeout(function(){for(var n=0;n<=t;n++){var r=e.container.children[n];if(t>=1&&n===t){var i=e._make("div",[e.CSS.barAdder],{});r.appendChild(i),e.api.listeners.on(i,"click",e.addBar.bind(e),!0)}if(t>=2&&n>=1&&n<=t-1){var a=e._make("div",[e.CSS.barDeleter],{});r.appendChild(a),e.api.listeners.on(a,"click",e.deleteBar.bind(e,r),!0)}}},100),n}},{key:"render",value:function(){var e=this.makeBar();this.container.appendChild(e);var t=this.makeBar();return this.container.appendChild(t),this.container}},{key:"save",value:function(e){return console.log("save: ",this.data),Object.assign(this.data,{})}},{key:"_make",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=document.createElement(e);Array.isArray(r)?(t=a.classList).add.apply(t,n(r)):r&&a.classList.add(r);for(var o in i)a[o]=i[o];return a}}],[{key:"sanitize",get:function(){return{title:{},message:{}}}}]),e}();e.exports=a}])});